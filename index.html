<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>–ú–∞–≥–∞–∑–∏–Ω "100 –†–µ–Ω—Ç–≥–µ–Ω"</title>
<style>
  :root{
    --accent:#ff9800;
    --bg:#850000;
    --panel-bg:rgba(18,18,18,0.96);
    --muted:#9aa;
    --card:#101010;
    --glass: rgba(255,255,255,0.03);
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:Inter,system-ui,Arial,sans-serif;background:url('https://i.imgur.com/Z1OWJQa.png') center/cover fixed;color:#fff}
  a{color:inherit}
  button,input,select,textarea{font:inherit}
  button{cursor:pointer}

  header{display:flex;justify-content:space-between;align-items:flex-start;padding:12px 18px;background:linear-gradient(180deg,rgba(0,0,0,0.6),rgba(0,0,0,0.2));gap:12px;position:sticky;top:0;z-index:40}
  .brand{display:flex;flex-direction:column}
  .brand h1{margin:0;font-size:18px}
  .controls{display:flex;flex-direction:column;align-items:flex-end;gap:8px}
  .top-buttons{display:flex;gap:8px}

  .categoryFilter{display:flex;gap:8px;align-items:center;overflow:auto;max-width:720px;padding-bottom:6px}
  .categoryFilter button{background:transparent;border:1px solid var(--glass);padding:6px 10px;border-radius:8px;color:#fff}
  .categoryFilter button.active{background:var(--accent);color:#000}

  .subcategoryContainer{margin-top:8px}
  .subcategoryFilter{display:flex;gap:6px;flex-wrap:wrap;max-height:88px;overflow:auto;padding:6px}
  .subcategoryFilter button{background:transparent;border:1px solid var(--glass);padding:6px 8px;border-radius:6px;color:#fff;font-size:13px}
  .subcategoryFilter button.active{background:var(--accent);color:#000}

  .container{padding:18px;display:flex;gap:18px;flex-wrap:wrap;justify-content:flex-start}
  .product-list{display:flex;flex-wrap:wrap;gap:18px}
  .product{width:220px;background:var(--panel-bg);padding:10px;border-radius:10px;border:1px solid var(--glass);cursor:pointer;transition:transform .12s}
  .product:hover{transform:translateY(-6px)}
  .product img{width:100%;height:140px;object-fit:cover;border-radius:6px}
  .product h3{margin:8px 0 4px;font-size:15px}
  .product p{margin:2px 0;color:var(--muted);font-size:13px}

  .panel{position:fixed;right:14px;top:72px;width:520px;max-height:80vh;overflow:auto;background:var(--panel-bg);padding:12px;border-radius:10px;border:1px solid var(--glass);display:none;z-index:60}
  @media(max-width:980px){ .panel{left:14px;right:14px;width:auto} .product{width:calc(50% - 24px)} }

  .list-item{display:flex;justify-content:space-between;gap:8px;padding:8px;border-radius:8px;border:1px solid var(--glass);margin-top:8px;background:linear-gradient(180deg,#0c0c0c,#0a0a0a)}

  .overlay{position:fixed;inset:0;background:rgba(0,0,0,0.6);backdrop-filter:blur(3px);display:none;z-index:80}
  .modal{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);background:#0b0b0b;padding:16px;border-radius:10px;border:1px solid var(--glass);z-index:90;display:none;max-width:920px;width:92%;max-height:92vh;overflow:auto}
  .modal .close{position:absolute;right:10px;top:8px;background:transparent;border:1px solid var(--glass);color:#fff;padding:6px;border-radius:6px}
  .modal h2{margin:0 0 8px}

  .product-view{
    display:flex;
    gap:24px;
    align-items:flex-start;
    flex-wrap: wrap;
  }
  .product-view-left{
    min-width: 320px;
    flex: 1;
    display: flex;
    justify-content: center;
  }
  .product-view-left img{
    width: 100%;
    max-width: 400px;
    height: 350px;
    object-fit: contain;
    border-radius: 10px;
    background: var(--card);
    padding: 12px;
    border: 1px solid var(--glass);
  }
  .product-view-right{
    flex: 1;
    min-width: 300px;
  }
  .product-view-right h3{
    margin:0 0 12px;
    font-size: 20px;
  }
  .muted{
    color:var(--muted);
    font-size:14px;
  }

  .attach-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:10px;margin-top:8px}
  .attach-card{background:#0d0d0d;border:1px solid var(--glass);padding:8px;border-radius:8px;display:flex;flex-direction:column;align-items:center;text-align:center;transition:.12s}
  .attach-card img{width:90px;height:90px;object-fit:cover;border-radius:6px}
  .attach-card .title{margin-top:8px;font-size:13px}
  .attach-card .price{font-size:13px;color:var(--muted)}
  .attach-card .row{margin-top:8px;display:flex;align-items:center;gap:6px}
  .attach-card.selected{border:2px solid var(--accent);background:linear-gradient(180deg, rgba(26,18,0,0.15), rgba(0,0,0,0.05))}

  .form-row{display:flex;gap:8px;flex-wrap:wrap}
  .form-col{flex:1;min-width:160px}
  input,select,textarea{width:100%;padding:8px;border-radius:8px;border:1px solid #222;background:#080808;color:#fff}
  textarea{min-height:80px}

  .btn{background:var(--accent);color:#000;padding:8px;border-radius:8px;border:none}
  .ghost{background:transparent;border:1px solid var(--glass);color:#fff;padding:6px;border-radius:6px}

  .small-muted{font-size:12px;color:var(--muted);margin-top:6px}
  .attach-row{display:flex;gap:8px;align-items:center;margin-top:8px}
  .attach-row input[type="text"], .attach-row input[type="number"], .attach-row select{padding:6px;border-radius:6px;background:#080808;border:1px solid #222;color:#fff}
  .msg-box{margin-top:8px;display:flex;gap:8px}
  .chat-note{margin-top:6px;font-size:13px;color:#ffdca8}
</style>
</head>
<body>

<header>
  <div class="brand">
    <h1>100 –†–µ–Ω—Ç–≥–µ–Ω ‚Äî –≤–Ω—É—Ç—Ä–∏–∏–≥—Ä–æ–≤–æ–π –º–∞–≥–∞–∑–∏–Ω</h1>
    <div class="muted">–ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ‚Äî —Ä–∞–±–æ—á–∞—è –≤–µ—Ä—Å–∏—è</div>
  </div>

  <div class="controls">
    <div class="top-buttons">
      <button id="btnCart" class="ghost">–ö–æ—Ä–∑–∏–Ω–∞</button>
      <button id="btnLogin" class="ghost">–í—Ö–æ–¥</button>
      <button id="btnMyOrders" class="ghost" style="display:none">–ú–æ–∏ –∑–∞—è–≤–∫–∏</button>
      <button id="btnSeller" class="ghost">–ü–∞–Ω–µ–ª—å –ø—Ä–æ–¥–∞–≤—Ü–∞</button>
    </div>

    <div class="categoryFilter" id="categoryFilter"></div>
    <div class="subcategoryContainer" id="subcategoryContainer"></div>
  </div>
</header>

<main class="container">
  <div id="productList" class="product-list"></div>
</main>

<div id="overlay" class="overlay"></div>

<div id="productModalView" class="modal" aria-hidden="true">
  <button class="close" id="closeProductView">‚úï</button>
  <div id="productViewContent"></div>
</div>

<div id="productModalEdit" class="modal" aria-hidden="true">
  <button class="close" id="closeProductEdit">‚úï</button>
  <h2 id="editTitle">–î–æ–±–∞–≤–∏—Ç—å / –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä</h2>
  <div id="productEditForm"></div>
</div>

<div id="cartPanel" class="panel">
  <h3>–ö–æ—Ä–∑–∏–Ω–∞</h3>
  <div id="cartItems"></div>
  <p>–ò—Ç–æ–≥–æ: <b id="cartTotal">0</b> üí∞</p>
  <div style="display:flex;gap:8px;justify-content:flex-end">
    <button id="btnCheckout" class="btn">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞—è–≤–∫—É</button>
  </div>
</div>

<div id="loginPanel" class="panel">
  <h3>–í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h3>
  <input id="username" placeholder="–ò–º—è" />
  <input id="password" placeholder="–ü–∞—Ä–æ–ª—å" type="password" />
  <div style="display:flex;gap:8px;margin-top:8px">
    <button id="btnRegister" class="btn">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
    <button id="btnSignIn" class="btn">–í–æ–π—Ç–∏</button>
  </div>
</div>

<div id="myOrdersPanel" class="panel">
  <h3>–ú–æ–∏ –∑–∞—è–≤–∫–∏</h3>
  <div id="myOrdersList"></div>
</div>

<div id="sellerPanel" class="panel">
  <h3>–ü–∞–Ω–µ–ª—å –ø—Ä–æ–¥–∞–≤—Ü–∞</h3>
  <div id="sellerLoginArea">
    <input id="sellerPass" placeholder="–ü–∞—Ä–æ–ª—å –ø—Ä–æ–¥–∞–≤—Ü–∞" type="password" />
    <div style="display:flex;gap:8px;margin-top:8px">
      <button id="btnSellerLogin" class="btn">–í–æ–π—Ç–∏</button>
      <button id="btnSellerCancel" class="ghost">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  </div>

  <div id="sellerArea" style="display:none;margin-top:12px">
    <div style="display:flex;gap:8px;margin-bottom:8px">
      <button id="tabOrders" class="ghost">–ó–∞—è–≤–∫–∏</button>
      <button id="tabProducts" class="ghost">–¢–æ–≤–∞—Ä—ã</button>
      <button id="tabCategories" class="ghost">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</button>
      <button id="btnSellerLogout" class="ghost" style="margin-left:auto">–í—ã–π—Ç–∏</button>
    </div>

    <div id="sellerOrdersSection">
      <div id="ordersList"></div>
    </div>

    <div id="sellerProductsSection" style="display:none">
      <div id="productsEditorList"></div>
      <div style="margin-top:12px">
        <button id="btnNewProduct" class="btn">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
      </div>
    </div>

    <div id="sellerCategoriesSection" style="display:none">
      <div style="margin-top:6px">
        <strong>–û—Å–Ω–æ–≤–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</strong>
        <div id="mainCategoriesList"></div>
        <div style="display:flex;gap:8px;margin-top:8px">
          <input id="newMainCat" placeholder="–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é" />
          <button id="btnAddMainCat" class="btn">–î–æ–±–∞–≤–∏—Ç—å</button>
        </div>
      </div>

      <div style="margin-top:12px">
        <strong>–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–≤—ã–±–µ—Ä–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω—É—é)</strong>
        <select id="subForMain"></select>
        <div id="subCatsList" style="margin-top:8px;max-height:180px;overflow:auto"></div>
        <div style="display:flex;gap:8px;margin-top:8px">
          <input id="newSubCat" placeholder="–î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é" />
          <button id="btnAddSubCat" class="btn">–î–æ–±–∞–≤–∏—Ç—å</button>
        </div>
      </div>

      <div style="margin-top:12px">
        <strong>–¢–∏–ø—ã –æ–±–≤–µ—Å–æ–≤</strong>
        <div id="attachTypesList"></div>
        <div style="display:flex;gap:8px;margin-top:8px">
          <input id="newAttachType" placeholder="–î–æ–±–∞–≤–∏—Ç—å —Ç–∏–ø –æ–±–≤–µ—Å–∞" />
          <button id="btnAddAttachType" class="btn">–î–æ–±–∞–≤–∏—Ç—å</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>// üîß –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø - –ó–ê–ú–ï–ù–ò–¢–ï –≠–¢–û!
const JSONBIN_BIN_ID = '6904b160ae596e708f3a36bf '; // –ù–∞–ø—Ä–∏–º–µ—Ä: '67a1b2c3d4e5f6a7b8c9d0e1'
const JSONBIN_MASTER_KEY = '$2a$10$wTicXNpl/tYWk2p1tuUuC.w87l4en0x8a9e7STVUKFIfFQnaZFdLC'; // –ò–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ jsonbin.io

// üî• –ë–ê–ó–ê –î–ê–ù–ù–´–• - –ü–†–û–°–¢–ê–Ø –ò –†–ê–ë–û–ß–ê–Ø
let shopData = {
    products: [],
    users: {},
    orders: {}, 
    chats: {}
};

let currentUser = null;
let cart = [];

// üì° –ê–ü–ò –î–õ–Ø –†–ê–ë–û–¢–´ –° –ë–ê–ó–û–ô
async function loadData() {
    try {
        const response = await fetch(`https://api.jsonbin.io/v3/b/${JSONBIN_BIN_ID}/latest`, {
            headers: { 'X-Master-Key': JSONBIN_MASTER_KEY }
        });
        const result = await response.json();
        shopData = result.record;
        console.log('–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', shopData);
    } catch (error) {
        console.log('–ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ');
    }
}

async function saveData() {
    try {
        await fetch(`https://api.jsonbin.io/v3/b/${JSONBIN_BIN_ID}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json',
                'X-Master-Key': JSONBIN_MASTER_KEY
            },
            body: JSON.stringify(shopData)
        });
        console.log('–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –æ–±–ª–∞–∫–æ!');
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
    }
}

// üéØ –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò –ú–ê–ì–ê–ó–ò–ù–ê
function renderProducts() {
    const container = document.getElementById('productList');
    container.innerHTML = '';
    
    shopData.products.forEach(product => {
        const productDiv = document.createElement('div');
        productDiv.className = 'product';
        productDiv.innerHTML = `
            <img src="${product.img}" alt="${product.name}">
            <h3>${product.name}</h3>
            <p><b>${product.price} ‚ÇΩ</b></p>
            <button onclick="addToCart(${product.id})">–í –∫–æ—Ä–∑–∏–Ω—É</button>
        `;
        container.appendChild(productDiv);
    });
}

function addToCart(productId) {
    const product = shopData.products.find(p => p.id === productId);
    if (product) {
        cart.push(product);
        updateCartUI();
        alert('–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É!');
    }
}

function updateCartUI() {
    const cartItems = document.getElementById('cartItems');
    const total = document.getElementById('cartTotal');
    
    cartItems.innerHTML = '';
    let sum = 0;
    
    cart.forEach(item => {
        sum += item.price;
        cartItems.innerHTML += `<div>${item.name} - ${item.price} ‚ÇΩ</div>`;
    });
    
    total.textContent = sum;
}

// üöÄ –ó–ê–ü–£–°–ö –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
async function init() {
    await loadData();
    renderProducts();
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫
    document.getElementById('btnCart').onclick = () => 
        document.getElementById('cartPanel').style.display = 'block';
    
    document.getElementById('btnCheckout').onclick = async () => {
        if (cart.length === 0) return alert('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞!');
        
        const order = {
            id: Date.now(),
            items: [...cart],
            total: cart.reduce((sum, item) => sum + item.price, 0),
            timestamp: new Date().toISOString()
        };
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–∫–∞–∑
        shopData.orders[order.id] = order;
        await saveData();
        
        cart = [];
        updateCartUI();
        alert('–ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω! ID: ' + order.id);
    };
}

// üì± –ó–ê–ì–†–£–ó–ö–ê –°–ê–ô–¢–ê
document.addEventListener('DOMContentLoaded', init);</script>

</body>
</html>