name: Fix JSONBin Keys

on:
  workflow_dispatch:

jobs:
  fix-keys:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    
    - name: Restore correct keys
      run: |
        # Правильные ключи (замените на ваши настоящие)
        MASTER_KEY='$2a$10$wTicXNpl/tYWk2p1tuUuC.w87l4en0x8a9e7STVUKFIfFQnaZFdLC'
        ACCESS_KEY='$2a$10$.twuYFU3QYQ1ZXPY.uyfB.7EryqBOUndWb3UbhjCfknwxJvHKo2LG'
        
        for file in index.html bets.html news.html; do
          if [ -f "$file" ]; then
            echo "Fixing $file"
            # Восстанавливаем правильные ключи
            sed -i "s|const JSONBIN_MASTER_KEY = .*|const JSONBIN_MASTER_KEY = '$MASTER_KEY';|g" "$file"
            sed -i "s|const JSONBIN_ACCESS_KEY = .*|const JSONBIN_ACCESS_KEY = '$ACCESS_KEY';|g" "$file"
          fi
        done
        
    - name: Deploy fix
      uses: peaceiris/actions-gh-pages@v4
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./
        force_orphan: true
